<!doctype html>
<html lang="es">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover" />

  <title>VK0 ‚Äî vINKo System</title>
  <meta name="description" content="VK0 es la m√°quina integrada (concepto en desarrollo) dise√±ada para trabajar con vINKo System: menos desperdicio, m√°s higiene y m√°s control del workflow." />

  <link rel="canonical" href="https://vinkosystem.com/system.html" />
  <link rel="alternate" href="https://vinkosystem.com/system.html" hreflang="es" />
  <link rel="alternate" href="https://vinkosystem.com/en.html" hreflang="en" />
  <link rel="alternate" href="https://vinkosystem.com/system.html" hreflang="x-default" />

  <!-- Open Graph / Twitter -->
  <meta property="og:type" content="website" />
  <meta property="og:site_name" content="vINKo System" />
  <meta property="og:title" content="VK0 ‚Äî vINKo System" />
  <meta property="og:description" content="La m√°quina integrada (concepto en desarrollo) para vINKo System: menos desperdicio, m√°s higiene y m√°s control del workflow." />
  <meta property="og:url" content="https://vinkosystem.com/system.html" />
  <meta property="og:image" content="https://vinkosystem.com/assets/img/vk0_concept.png" />

  <meta name="twitter:card" content="summary_large_image" />
  <meta name="twitter:title" content="VK0 ‚Äî vINKo System" />
  <meta name="twitter:description" content="La m√°quina integrada (concepto en desarrollo) para vINKo System." />
  <meta name="twitter:image" content="https://vinkosystem.com/assets/img/vk0_concept.png" />

  <link rel="stylesheet" href="styles.css?v=1.0.19" />

  <!-- Preloads -->
  <link rel="preload" href="/assets/img/LogoBlanco.png" as="image">
  <link rel="preload" href="/assets/img/vk0_concept.png" as="image">

  <!-- AOS -->
  <link rel="stylesheet" href="https://unpkg.com/aos@2.3.4/dist/aos.css" />

  <!-- Icons -->
  <link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicon-16x16.png">
  <link rel="icon" type="image/png" sizes="48x48" href="/assets/img/favicon-48x48.png">
  <link rel="icon" href="/assets/img/favicon.ico" sizes="any">
  <link rel="apple-touch-icon" href="/apple-touch-icon.png">
  <link rel="manifest" href="/site.webmanifest">
  <meta name="theme-color" content="#0b0f14">
</head>

<body class="page-system">
  <header class="header">
    <a class="brand" href="index.html" aria-label="Ir al inicio">
      <span class="brand-dot"></span>
      <span>vINKo System</span>
    </a>

    <!-- Bot√≥n men√∫ m√≥vil -->
    <button class="nav-toggle" type="button" aria-label="Abrir men√∫" aria-expanded="false" aria-controls="site-nav">
      <span class="nav-toggle-bar"></span>
      <span class="nav-toggle-bar"></span>
      <span class="nav-toggle-bar"></span>
    </button>

    <div class="header-right" id="site-nav">
      <nav class="nav" aria-label="Navegaci√≥n principal">
        <a href="vk0.html">VK0</a>
        <a href="system.html">vINKo System</a>
        <a href="faq.html">FAQ</a>
        <a href="sobre-mi.html">Sobre m√≠</a>
        <a href="lista.html" class="btn primary">Lista de espera</a>
      </nav>

      <!-- Selector de idioma (ES actual) -->
      <div class="lang-switch" aria-label="Idioma del sitio">
        <button class="lang current" type="button" aria-label="Idioma actual: espa√±ol">
          <span class="flag">üá™üá∏</span><span class="code">ES</span>
        </button>
        <a class="lang" href="en.html" aria-label="Cambiar a ingl√©s">
          <span class="flag">üá¨üáß</span><span class="code">EN</span>
        </a>
      </div>
    </div>
  </header>

  <main id="main">
    <!-- HERO (explosi√≥n Apple-like) -->
    <section id="top" class="vk0-scroll-hero" aria-label="vINKo System scroll animation" data-scroll-mult="3" data-fps="50" data-fade-sec="0.45">
      <div class="vk0-sticky">
        <canvas
          id="vk0-seq"
          class="vk0-scroll-canvas"
          data-desktop="/assets/video-explicativo/desktop/frame_%04d.webp"
          data-mobile="/assets/video-explicativo/mobile/frame_%04d.webp"
          data-frames="702"
          aria-hidden="true"
        ></canvas>

        <div class="vk0-shade" aria-hidden="true"></div>

        <div class="vk0-steps" aria-hidden="false">
          <!-- Step 1 -->
          <div class="vk0-step" data-at="0" data-for="1.7">
            <div class="vk0-top"><h1>C√≥mo Funciona</h1></div>
            <div class="vk0-bottom"><p>vINKo System, en 4 pasos.</p></div>
          </div>

          <!-- Step 2 -->
          <div class="vk0-step" data-at="2" data-for="2.6">
            <div class="vk0-top"><h2>Introducimos Cartucho</h2></div>
            <div class="vk0-bottom"><p>Preparaci√≥n r√°pida y ordenada.</p></div>
          </div>

          <!-- Step 3 -->
          <div class="vk0-step" data-at="5" data-for="3.4">
            <div class="vk0-top"><h2>Activamos el sistema</h2></div>
            <div class="vk0-bottom"><p>Listo para trabajar con ‚Äúlo justo‚Äù.</p></div>
          </div>

          <!-- Step 4 -->
          <div class="vk0-step" data-at="9" data-for="3.4">
            <div class="vk0-top"><h2>Tatuamos</h2></div>
            <div class="vk0-bottom"><p>M√°s control, menos interrupciones.</p></div>
          </div>

          <!-- Step 5 (Final) -->
          <div class="vk0-step" data-at="end" data-for="999" data-hold="1">
            <div class="vk0-top"><h2>As√≠ de sencillo, ¬øte apuntas?</h2></div>
            <div class="vk0-bottom">
              <p>Entra en la lista para recibir el aviso primero.</p>
              <div class="vk0-cta">
                <a class="btn primary" href="lista.html">Lista de espera</a>
              </div>
            </div>
          </div>
        </div>
      </div>
    </section>

      <!-- Placeholder oculto por compatibilidad si tu main.js espera #earlyForm -->
      <form id="earlyForm" class="hidden" aria-hidden="true"></form>
  </main>

  <footer class="footer">
    <div class="footer-inner">
      <div class="brand small">
        <span class="brand-dot"></span><span>vINKo System</span>
      </div>

      <div class="footer-links">
        <a href="vk0.html">VK0</a>
        <a href="vINKoSystem.html">vINKo System</a>
        <a href="faq.html">FAQ</a>
        <a href="sobre-mi.html">Sobre m√≠</a>
        <a href="lista.html">Lista</a>
      </div>

      <div class="footer-right">
        <div class="social-links" aria-label="Redes sociales de vINKo System">
          <a href="https://www.linkedin.com/company/vinko-system" target="_blank" rel="noopener noreferrer" aria-label="LinkedIn">
            <img src="assets/img/linkedin.svg" alt="LinkedIn" class="social-icon" />
          </a>
          <a href="https://www.instagram.com/vinko.system" target="_blank" rel="noopener noreferrer" aria-label="Instagram">
            <img src="assets/img/instagram.svg" alt="Instagram" class="social-icon" />
          </a>
          <a href="https://www.tiktok.com/@vinko.tech" target="_blank" rel="noopener noreferrer" aria-label="TikTok">
            <img src="assets/img/tiktok.svg" alt="TikTok" class="social-icon" />
          </a>
        </div>

        <div class="lang-switch small" aria-label="Idioma del sitio">
          <button class="lang current" type="button" aria-label="Idioma actual: espa√±ol">
            <span class="flag">üá™üá∏</span><span class="code">ES</span>
          </button>
          <a class="lang" href="en.html" aria-label="Cambiar a ingl√©s">
            <span class="flag">üá¨üáß</span><span class="code">EN</span>
          </a>
        </div>

        <div class="footer-meta">
          ¬© <span id="year"></span> vINKo System. Todos los derechos reservados.
        </div>

        <div class="footer-meta" style="margin-top:6px;">
          <a href="/privacy.html">Privacidad</a> ¬∑ <a href="/cookies.html">Cookies</a> ¬∑ <a href="lista.html">Contacto</a>
        </div>
      </div>
    </div>
  </footer>

  <!-- AOS JS -->
  <script src="https://unpkg.com/aos@2.3.4/dist/aos.js"></script>
  <script>
    document.addEventListener("DOMContentLoaded", () => {
      AOS.init({
        duration: 700,
        easing: "ease-out",
        offset: 80,
        once: true
      });
    });
  </script>

<!-- VK0 Scroll Animation (Apple-like) -->
  <script>
    window.addEventListener('DOMContentLoaded', () => {
      const section = document.querySelector('.vk0-scroll-hero');
      if (!section) return;

      const sticky = section.querySelector('.vk0-sticky');
      const canvas = document.getElementById('vk0-seq');
      const header = document.querySelector('.header');

      // Fix 100vh en m√≥vil (barras din√°micas)
      const setVH = () => {
        document.documentElement.style.setProperty('--vh', `${window.innerHeight * 0.01}px`);
      };
      setVH();

      // Ajuste: secuencia m√°s larga => m√°s scroll para que no vaya demasiado r√°pido
      const scrollMult = Math.max(1, parseFloat(section.dataset.scrollMult || '1') || 1);
      let baseSectionH = null;
      const applyScrollMult = () => {
        if (baseSectionH === null) baseSectionH = section.offsetHeight;
        const baseline = Math.max(baseSectionH, window.innerHeight * 3);
        section.style.height = `${Math.round(baseline * scrollMult)}px`;
      };
      applyScrollMult();

      // ---- PIN ROBUSTO (tipo Apple) ----
      let headerH = 0;
      let start = 0;
      let end = 0;
      let scrollable = 1;

      const recalc = () => {
        headerH = header ? header.offsetHeight : 0;
        start = section.offsetTop - headerH;
        scrollable = Math.max(1, section.offsetHeight - window.innerHeight);
        end = start + scrollable;

        const bottomTop = Math.max(0, section.offsetHeight - window.innerHeight);
        section.style.setProperty('--vk0-bottom-top', `${bottomTop}px`);
      };
      recalc();

      const updatePin = () => {
        if (!sticky) return;
        const y = window.scrollY || window.pageYOffset || 0;

        sticky.classList.remove('is-fixed', 'is-bottom');
        if (y >= start && y < end) sticky.classList.add('is-fixed');
        else if (y >= end) sticky.classList.add('is-bottom');
      };

      const clamp01 = (x) => Math.min(1, Math.max(0, x));
      const progressInSection = () => {
        const y = window.scrollY || window.pageYOffset || 0;
        return clamp01((y - start) / scrollable);
      };

      updatePin();
      window.addEventListener('scroll', updatePin, { passive: true });
      window.addEventListener('resize', () => {
        setVH();
        applyScrollMult();
        recalc();
        updatePin();
        if (canvas) resizeCanvas();
      }, { passive: true });
      // ---- TEXTO (steps) ----
      // Control de textos por SEGUNDOS (data-at/data-for). Mantiene compatibilidad con data-start/data-end.
      const stepEls = Array.from(section.querySelectorAll('.vk0-step'));
      let steps = [];
      let stepFade = 0.08;

      const buildSteps = () => {
        const fps = parseFloat(section.dataset.fps || '50') || 50;
        const framesFromDataset = canvas ? parseInt(canvas.dataset.frames || '0', 10) : 0;
        const frames = (framesFromDataset && framesFromDataset > 0) ? framesFromDataset : totalFrames;
        const durationSec = (frames && frames > 0) ? (frames / fps) : 1;

        const fadeSec = parseFloat(section.dataset.fadeSec || '0.45') || 0.45;
        stepFade = Math.min(0.08, Math.max(0.012, clamp01(fadeSec / durationSec)));

        steps = stepEls.map(el => {
          // Compatibilidad: porcentajes (0..1)
          if (el.dataset.start && el.dataset.end) {
            return { el, start: parseFloat(el.dataset.start || '0'), end: parseFloat(el.dataset.end || '1') };
          }

          const atRaw = (el.dataset.at || '0').trim().toLowerCase();
          const forSecRaw = parseFloat(el.dataset.for || '2');
          const forSec = Number.isFinite(forSecRaw) ? forSecRaw : 2;

          let atSec = 0;
          if (atRaw === 'end') atSec = Math.max(0, durationSec - 1.2);
          else atSec = parseFloat(atRaw || '0') || 0;

          const start = clamp01(atSec / durationSec);
          const end = clamp01((atSec + forSec) / durationSec);
          return { el, start, end };
        });
      };

      buildSteps();


      const smoothstep = (a, b, x) => {
        const t = clamp01((x - a) / (b - a));
        return t * t * (3 - 2 * t);
      };

      // Entrada/salida con transici√≥n breve pero ‚Äúdirecta‚Äù
      const windowFade = (p, start, end, fade = stepFade) => {
        const i = smoothstep(start, start + fade, p);
        const o = 1 - smoothstep(end - fade, end, p);
        return clamp01(i * o);
      };

      const renderSteps = (p) => {
        for (const s of steps) {
          const hold = s.el.dataset.hold === '1';
          const o = hold
          ? smoothstep(s.start, s.start + stepFade, p)         // aparece y se queda
          : windowFade(p, s.start, s.end, stepFade);           // comportamiento normal
          const y = (1 - o) * 16;
          const blur = (1 - o) * 5;
          const scale = 0.985 + (o * 0.015);

          s.el.style.opacity = o.toFixed(3);
          s.el.style.transform = `translateY(${y.toFixed(1)}px) scale(${scale.toFixed(3)})`;
          s.el.style.filter = `blur(${blur.toFixed(2)}px)`;
          s.el.style.pointerEvents = o > 0.6 ? 'auto' : 'none';
        }
      };

      // ---- CANVAS SEQUENCE (Apple-level) ----
      let ctx = null;
      let totalFrames = 0;
      let tplDesktop = '';
      let tplMobile = '';

      let imgs = [];
      let loaded = [];

      let current = 1;
      let target = 1;

      const easeFrames = 0.22; // sube a 0.28 si lo quieres m√°s pegado al scroll

      const isMobile = () => window.matchMedia('(max-width: 720px)').matches;

      const frameUrl = (i) => {
        const tpl = isMobile() ? tplMobile : tplDesktop;
        const n = String(i).padStart(4, '0');
        return tpl.replace('%04d', n);
      };

      function resizeCanvas() {
        if (!canvas || !ctx) return;
        const dpr = Math.min(2, window.devicePixelRatio || 1);
        const w = canvas.clientWidth;
        const h = canvas.clientHeight;

        canvas.width = Math.round(w * dpr);
        canvas.height = Math.round(h * dpr);
        ctx.setTransform(dpr, 0, 0, dpr, 0, 0);
      }

      function drawSmart(img) {
        if (!canvas || !ctx) return;

        const cw = canvas.clientWidth;
        const ch = canvas.clientHeight;
        const iw = img.naturalWidth;
        const ih = img.naturalHeight;

        // M√≥vil: contain (no recorta). Desktop: cover (cinem√°tico).
        const contain = isMobile();
        const scale = contain ? Math.min(cw / iw, ch / ih) : Math.max(cw / iw, ch / ih);

        const dw = iw * scale;
        const dh = ih * scale;
        const dx = (cw - dw) / 2;
        const dy = (ch - dh) / 2;

        ctx.clearRect(0, 0, cw, ch);
        ctx.drawImage(img, dx, dy, dw, dh);
      }

      function loadFrame(i) {
        if (!canvas || !ctx) return;
        if (i < 1 || i > totalFrames) return;
        if (imgs[i]) return;

        const img = new Image();
        img.decoding = 'async';
        img.src = frameUrl(i);
        imgs[i] = img;
        img.onload = () => { loaded[i] = true; };
      }

      function preloadWindow(center) {
        // Ventana alrededor del frame actual (50fps => m√°s radio)
        const r = isMobile() ? 24 : 34;
        for (let i = center - r; i <= center + r; i++) loadFrame(i);
      }

      // Loop (solo mientras el HERO est√° en viewport)
      let raf = 0;
      let active = false;

      function tick() {
        if (!active) { raf = 0; return; }

        const p = progressInSection();

        // Steps siempre
        renderSteps(p);

        // Frames si hay secuencia
        if (ctx && totalFrames > 0) {
          target = 1 + p * (totalFrames - 1);
          current += (target - current) * easeFrames;

          const idx = Math.max(1, Math.min(totalFrames, Math.round(current)));
          preloadWindow(idx);

          const img = imgs[idx];
          if (img && (img.complete || loaded[idx])) drawSmart(img);
        }

        raf = requestAnimationFrame(tick);
      }

      const io = new IntersectionObserver((entries) => {
        active = entries.some(e => e.isIntersecting);
        if (active && !raf) raf = requestAnimationFrame(tick);
      }, { threshold: 0.01 });

      io.observe(section);

      // Init (primer render para que se vea texto inmediatamente)
      renderSteps(progressInSection());

      // Setup canvas (si existe)
      if (canvas) {
        ctx = canvas.getContext('2d', { alpha: false });
        totalFrames = parseInt(canvas.dataset.frames || '0', 10);
        tplDesktop = canvas.dataset.desktop || '';
        tplMobile = canvas.dataset.mobile || '';

        // Recalcula ventanas de texto (segundos -> progreso) seg√∫n duraci√≥n
        buildSteps();
        renderSteps(progressInSection());

        imgs = new Array(totalFrames + 1);
        loaded = new Array(totalFrames + 1).fill(false);

        resizeCanvas();

        // Preload inicial (r√°pido para evitar negro)
        const initN = Math.min(50, totalFrames);
        for (let i = 1; i <= initN; i++) loadFrame(i);
        loadFrame(1);

        // Dibuja el primer frame cuando est√© listo
        const drawFirst = () => {
          const img = imgs[1];
          if (img && img.complete) drawSmart(img);
          else requestAnimationFrame(drawFirst);
        };
        requestAnimationFrame(drawFirst);

        // Si cambia el breakpoint (mobile/desktop), vaciamos cache para usar la otra carpeta
        const mq = window.matchMedia('(max-width: 720px)');
        mq.addEventListener('change', () => {
          imgs = new Array(totalFrames + 1);
          loaded = new Array(totalFrames + 1).fill(false);
          resizeCanvas();
          for (let i = 1; i <= initN; i++) loadFrame(i);
          loadFrame(1);
          renderSteps(progressInSection());
        });
      }
    });
  </script>

<script src="main.js?v=1.0.6" defer></script>
</body>
</html>
